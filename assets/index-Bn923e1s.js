import{i as C,h as g,a as j,j as e,b as v,r as P,d as N,q as L}from"./index-BvpcFvom.js";import{Q as y,u as b}from"./useBaseQuery-BiqM6kST.js";import{B as F}from"./btn-C4DmeqXX.js";import"./tabbar-service-CWfIt1kq.js";import{S as w}from"./skeleton-ljux3ciK.js";import{P as E,s as M}from"./sleep-BiBF8z-F.js";var R=class extends y{constructor(s,t){super(s,t)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(s,t){super.setOptions({...s,behavior:C()},t)}getOptimisticResult(s){return s.behavior=C(),super.getOptimisticResult(s)}fetchNextPage(s){return this.fetch({...s,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(s){return this.fetch({...s,meta:{fetchMore:{direction:"backward"}}})}createResult(s,t){var n,p;const{state:a}=s,o=super.createResult(s,t),{isFetching:c,isRefetching:m,isError:h,isRefetchError:x}=o,i=(p=(n=a.fetchMeta)==null?void 0:n.fetchMore)==null?void 0:p.direction,d=h&&i==="forward",l=c&&i==="forward",u=h&&i==="backward",r=c&&i==="backward";return{...o,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:g(t,a.data),hasPreviousPage:j(t,a.data),isFetchNextPageError:d,isFetchingNextPage:l,isFetchPreviousPageError:u,isFetchingPreviousPage:r,isRefetchError:x&&!d&&!u,isRefetching:m&&!l&&!r}}};function O(s,t){return b(s,R)}const k=s=>e.jsx("svg",{fill:"currentColor",width:"1em",height:"1em",viewBox:"0 0 64 64",...s,children:e.jsx("g",{id:"\\u8FD0\\u8425\\u5546\\u67E5\\u8BE2",stroke:"none",strokeWidth:1,fill:"none",fillRule:"evenodd",children:e.jsx("g",{id:"\\u6211\\u7684\\u8BA2\\u5355",transform:"translate(-16.000000, -184.000000)",children:e.jsx("g",{id:"\\u7F16\\u7EC4-3",transform:"translate(16.000000, 184.000000)",children:e.jsxs("g",{id:"huafei",children:[e.jsx("circle",{id:"\\u692D\\u5706\\u5F62",fill:"#41D8CF",cx:32,cy:32,r:32}),e.jsxs("g",{id:"\\u7F16\\u7EC4",transform:"translate(18.526316, 13.473684)",fill:"#FFFFFF",fillRule:"nonzero",children:[e.jsx("path",{d:"M23.2568204,0.0373903865 C23.7055051,0.0373903865 24.1541897,0.11217116 24.565484,0.299123092 C24.9767782,0.486075025 25.3132917,0.710417344 25.6124148,1.00954044 C25.9115379,1.30866353 26.1358802,1.68256739 26.3228321,2.05647126 C26.5097841,2.46776551 26.5845648,2.87905976 26.5845648,3.36513479 L26.5845648,33.2026632 C26.5845648,34.1374229 26.2480513,34.922621 25.6124148,35.5582576 C24.9767782,36.1938942 24.1915801,36.5304076 23.2568204,36.5304076 L3.3277444,36.5304076 C2.39298474,36.5304076 1.60778662,36.1938942 0.97215005,35.5582576 C0.336513479,34.922621 2.55795385e-13,34.1374229 2.55795385e-13,33.2026632 L2.55795385e-13,3.3277444 C2.55795385e-13,2.87905976 0.0747807731,2.43037512 0.261732706,2.01908087 C0.448684638,1.60778662 0.673026958,1.27127314 0.97215005,0.97215005 C1.27127314,0.673026958 1.64517701,0.448684638 2.01908087,0.261732706 C2.43037512,0.0747807731 2.84166938,7.17648163e-13 3.3277444,7.17648163e-13 L23.2568204,7.17648163e-13 L23.2568204,0.0373903865 L23.2568204,0.0373903865 Z M9.9832332,3.36513479 L16.6013316,3.36513479 L16.6013316,1.68256739 L9.9832332,1.68256739 L9.9832332,3.36513479 Z M13.2735872,34.8478403 C13.7222719,34.8478403 14.1709565,34.7730595 14.5822507,34.5861075 C14.993545,34.3991556 15.3300585,34.1748133 15.6291816,33.8756902 C15.9283047,33.5765671 16.152647,33.2026632 16.3395989,32.8287594 C16.5265508,32.4174651 16.6013316,32.0061709 16.6013316,31.5200958 C16.6013316,31.0340208 16.5265508,30.6227266 16.3395989,30.2114323 C16.152647,29.8001381 15.9283047,29.4636246 15.6291816,29.1645015 C15.3300585,28.8653784 14.9561546,28.6410361 14.5822507,28.4540842 C14.1709565,28.2671322 13.7596622,28.1923514 13.2735872,28.1923514 C12.3388276,28.1923514 11.5536294,28.4914745 10.9553833,29.1271111 C10.3197467,29.7627477 10.0206236,30.5479458 10.0206236,31.4453151 C10.0206236,32.3426844 10.3197467,33.1652729 10.9553833,33.8009094 C11.5536294,34.5487172 12.3388276,34.8478403 13.2735872,34.8478403 L13.2735872,34.8478403 Z M23.2568204,5.0103118 L3.3277444,5.0103118 L3.3277444,26.5845648 L23.2568204,26.5845648 L23.2568204,5.0103118 Z",id:"\\u5F62\\u72B6"}),e.jsx("path",{d:"M19.5177818,16.7882836 C19.8169049,16.7882836 20.0786376,16.5265508 20.0786376,16.2274278 L20.0786376,15.47962 C20.0786376,15.1804969 19.8169049,14.9187642 19.5177818,14.9187642 L15.47962,14.9187642 L19.7421241,10.6562602 C20.1534183,10.2449659 20.1534183,9.53454857 19.7421241,9.08586393 C19.3308298,8.67456968 18.6204125,8.67456968 18.2091182,9.08586393 L13.6474911,13.6474911 L9.08586393,9.04847354 C8.67456968,8.63717929 7.96415233,8.63717929 7.55285808,9.04847354 C7.14156383,9.45976779 7.14156383,10.1701851 7.55285808,10.6188698 L11.8153621,14.8813738 L7.17895421,14.8813738 C6.87983112,14.8813738 6.61809842,15.1431065 6.61809842,15.4422296 L6.61809842,16.1900374 C6.61809842,16.4891605 6.87983112,16.7508932 7.17895421,16.7508932 L12.1518756,16.7508932 L12.1518756,19.2186587 L7.17895421,19.2186587 C6.87983112,19.2186587 6.6554888,19.443001 6.6554888,19.7421241 L6.6554888,20.4899318 C6.6554888,20.7890549 6.87983112,21.0133972 7.17895421,21.0133972 L12.1518756,21.0133972 L12.1518756,23.2568204 C12.1518756,23.7055051 12.5257795,24.0794089 12.9744641,24.0794089 L13.7970526,24.0794089 C14.2457373,24.0794089 14.6196411,23.7055051 14.6196411,23.2568204 L14.6196411,21.0133972 L19.5925625,21.0133972 C19.8916856,21.0133972 20.116028,20.7890549 20.116028,20.4899318 L20.116028,19.7421241 C20.116028,19.443001 19.8916856,19.2186587 19.5925625,19.2186587 L14.6196411,19.2186587 L14.6196411,16.7508932 L19.5177818,16.7508932 L19.5177818,16.7882836 Z",id:"\\u8DEF\\u5F84"})]})]})})})})}),B=s=>e.jsx("svg",{viewBox:"0 0 24 24",width:"1.2em",height:"1.2em",...s,children:e.jsx("path",{fill:"currentColor",d:"M20 12a8 8 0 0 0-8-8a8 8 0 0 0-8 8a8 8 0 0 0 8 8a8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12A10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5s-1.5-.7-1.5-1.5s.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5S7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"})});function S({children:s,onClick:t}){return e.jsxs("div",{className:"w-full h-52 flex items-center justify-center flex-col",style:{height:"var(--content-height)"},children:[e.jsx(B,{className:"text-primary",fontSize:80}),e.jsx("p",{className:"mt-4 font-bold text-primary text-md mx-2",children:s}),e.jsx(F,{onClick:t,className:"px-4",children:"重试"})]})}function D({data:s}){const t=v();return e.jsxs("div",{className:"px-[16px] pt-[46px] border-b h-[285px] box-border",onClick:()=>{t(`/order/${s.id}`)},children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"text-[64px]"}),e.jsx("span",{className:"text-xl ml-[7px] leading-none",children:s.phone}),e.jsx("div",{className:"flex-1"}),e.jsxs("span",{className:"text-primary text-xl leading-none",children:["-￥",s.price]})]}),e.jsxs("p",{className:"text-primary leading-none text-md mt-[10px]  h-[44px] flex items-center",children:["充值商品：",s.productName," ",s.id]}),e.jsxs("p",{className:"text-[#666666] leading-none text-md  h-[44px] flex items-center",children:["订单编号：",s.orderNo.slice(-20)]}),e.jsxs("div",{className:"text-sm flex justify-between items-center h-[78px] ",children:[e.jsx("span",{className:"text-[#C1C0C0]",children:s.time}),s.status==="success"?e.jsx("span",{className:"text-[#FA6400]",children:"充值成功"}):e.jsx("span",{className:"text-[#2D9852]",children:"充值失败"})]})]})}function Q(){const s=Array.from({length:8});return e.jsx("div",{className:"w-full",children:s.map((t,a)=>e.jsx("div",{className:"w-full px-[16px] pt-[46px] border-b h-[285px] box-border overflow-hidden",children:e.jsx(w,{count:3,containerClassName:"flex flex-col justify-between h-full pb-md",inline:!0,style:{display:"flex",fontSize:24}})},a))})}function _(){const[s,t]=P.useState(!0),{fetchNextPage:a,refetch:o,data:c,hasNextPage:m,isFetchingNextPage:h,status:x,error:i}=O({queryKey:["order","list"],queryFn:({pageParam:r=1})=>u(r),initialPageParam:1,getNextPageParam:(r,f)=>{const n=f.length+1;return n<=3?n:void 0}}),d=(c==null?void 0:c.pages.flat())??[];async function l(){L.setQueryData(["order","list"],r=>({pages:r.pages.slice(0,1),pageParams:r.pageParams.slice(0,1)})),await o()}async function u(r){if(await M(10*0),r<1||r>3)return t(!1),[];const f=await fetch(`/project-preview/data/order-${r}.json`).then(n=>n.json());return t(r<3),f}return x==="pending"?e.jsx("div",{className:"h-[100vh]  overflow-hidden",children:e.jsx(Q,{})}):x==="error"?e.jsxs(S,{onClick:()=>l(),children:["请求失败："," ",i==null?void 0:i.message]}):e.jsx("div",{className:"h-[100vh]",children:e.jsx(E,{onRefresh:l,canFetchMore:s,onFetchMore:async()=>{m&&await a()},children:e.jsxs("div",{children:[d.map(r=>e.jsx(D,{data:r},r.id)),h?e.jsxs("div",{className:"flex items-center justify-center px-3 text-md py-2  text-[#CECECE]",children:[e.jsx(N,{size:"small",color:"#CECECE",style:{fontSize:"0.2em",lineHeight:"1"}}),e.jsx("span",{className:"ml-[10px]",children:"数据加载中"})]}):e.jsx("div",{className:"flex items-center justify-between px-3 text-md py-2 baseline text-[#CECECE]",children:"我是有底线的"})]})})})}export{_ as default};
