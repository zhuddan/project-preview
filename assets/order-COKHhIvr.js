var gt=t=>{throw TypeError(t)};var st=(t,e,s)=>e.has(t)||gt("Cannot "+s);var r=(t,e,s)=>(st(t,e,"read from private field"),s?s.call(t):e.get(t)),b=(t,e,s)=>e.has(t)?gt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),l=(t,e,s,i)=>(st(t,e,"write to private field"),i?i.call(t,s):e.set(t,s),s),f=(t,e,s)=>(st(t,e,"access private method"),s);import{S as Mt,h as w,s as H,i as W,n as _t,k as yt,l as vt,t as kt,m as Kt,o as Bt,p as mt,v as Y,w as Ot,x as qt,y as zt,z as Rt,A as Vt,r as y,C as jt,a as Wt}from"./index-DsutIs27.js";import{s as J}from"./sleep-AcpSZMhY.js";var R,o,z,m,N,L,C,V,$,A,U,D,M,_,c,q,rt,it,nt,at,ot,ht,ut,Qt,xt,Ft=(xt=class extends Mt{constructor(e,s){super();b(this,c);b(this,R);b(this,o);b(this,z);b(this,m);b(this,N);b(this,L);b(this,C);b(this,V);b(this,$);b(this,A);b(this,U);b(this,D);b(this,M);b(this,_,new Set);this.options=s,l(this,R,e),l(this,C,null),this.bindMethods(),this.setOptions(s)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(r(this,o).addObserver(this),St(r(this,o),this.options)?f(this,c,q).call(this):this.updateResult(),f(this,c,at).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ct(r(this,o),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ct(r(this,o),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,f(this,c,ot).call(this),f(this,c,ht).call(this),r(this,o).removeObserver(this)}setOptions(e,s){const i=this.options,n=r(this,o);if(this.options=r(this,R).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof w(this.options.enabled,r(this,o))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");f(this,c,ut).call(this),r(this,o).setOptions(this.options),i._defaulted&&!H(this.options,i)&&r(this,R).getQueryCache().notify({type:"observerOptionsUpdated",query:r(this,o),observer:this});const u=this.hasListeners();u&&Pt(r(this,o),n,this.options,i)&&f(this,c,q).call(this),this.updateResult(s),u&&(r(this,o)!==n||w(this.options.enabled,r(this,o))!==w(i.enabled,r(this,o))||W(this.options.staleTime,r(this,o))!==W(i.staleTime,r(this,o)))&&f(this,c,rt).call(this);const a=f(this,c,it).call(this);u&&(r(this,o)!==n||w(this.options.enabled,r(this,o))!==w(i.enabled,r(this,o))||a!==r(this,M))&&f(this,c,nt).call(this,a)}getOptimisticResult(e){const s=r(this,R).getQueryCache().build(r(this,R),e),i=this.createResult(s,e);return Ht(this,i)&&(l(this,m,i),l(this,L,this.options),l(this,N,r(this,o).state)),i}getCurrentResult(){return r(this,m)}trackResult(e,s){const i={};return Object.keys(e).forEach(n=>{Object.defineProperty(i,n,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(n),s==null||s(n),e[n])})}),i}trackProp(e){r(this,_).add(e)}getCurrentQuery(){return r(this,o)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const s=r(this,R).defaultQueryOptions(e),i=r(this,R).getQueryCache().build(r(this,R),s);return i.isFetchingOptimistic=!0,i.fetch().then(()=>this.createResult(i,s))}fetch(e){return f(this,c,q).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),r(this,m)))}createResult(e,s){var pt;const i=r(this,o),n=this.options,u=r(this,m),a=r(this,N),d=r(this,L),v=e!==i?e.state:r(this,z),{state:p}=e;let h={...p},T=!1,O;if(s._optimisticResults){const P=this.hasListeners(),et=!P&&St(e,s),At=P&&Pt(e,i,s,n);(et||At)&&(h={...h,...Bt(p.data,e.options)}),s._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:Q,errorUpdatedAt:K,status:I}=h;if(s.select&&h.data!==void 0)if(u&&h.data===(a==null?void 0:a.data)&&s.select===r(this,V))O=r(this,$);else try{l(this,V,s.select),O=s.select(h.data),O=mt(u==null?void 0:u.data,O,s),l(this,$,O),l(this,C,null)}catch(P){l(this,C,P)}else O=h.data;if(s.placeholderData!==void 0&&O===void 0&&I==="pending"){let P;if(u!=null&&u.isPlaceholderData&&s.placeholderData===(d==null?void 0:d.placeholderData))P=u.data;else if(P=typeof s.placeholderData=="function"?s.placeholderData((pt=r(this,A))==null?void 0:pt.state.data,r(this,A)):s.placeholderData,s.select&&P!==void 0)try{P=s.select(P),l(this,C,null)}catch(et){l(this,C,et)}P!==void 0&&(I="success",O=mt(u==null?void 0:u.data,P,s),T=!0)}r(this,C)&&(Q=r(this,C),O=r(this,$),K=Date.now(),I="error");const X=h.fetchStatus==="fetching",Z=I==="pending",tt=I==="error",ft=Z&&X,bt=O!==void 0;return{status:I,fetchStatus:h.fetchStatus,isPending:Z,isSuccess:I==="success",isError:tt,isInitialLoading:ft,isLoading:ft,data:O,dataUpdatedAt:h.dataUpdatedAt,error:Q,errorUpdatedAt:K,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>v.dataUpdateCount||h.errorUpdateCount>v.errorUpdateCount,isFetching:X,isRefetching:X&&!Z,isLoadingError:tt&&!bt,isPaused:h.fetchStatus==="paused",isPlaceholderData:T,isRefetchError:tt&&bt,isStale:dt(e,s),refetch:this.refetch}}updateResult(e){const s=r(this,m),i=this.createResult(r(this,o),this.options);if(l(this,N,r(this,o).state),l(this,L,this.options),r(this,N).data!==void 0&&l(this,A,r(this,o)),H(i,s))return;l(this,m,i);const n={},u=()=>{if(!s)return!0;const{notifyOnChangeProps:a}=this.options,d=typeof a=="function"?a():a;if(d==="all"||!d&&!r(this,_).size)return!0;const g=new Set(d??r(this,_));return this.options.throwOnError&&g.add("error"),Object.keys(r(this,m)).some(v=>{const p=v;return r(this,m)[p]!==s[p]&&g.has(p)})};(e==null?void 0:e.listeners)!==!1&&u()&&(n.listeners=!0),f(this,c,Qt).call(this,{...n,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&f(this,c,at).call(this)}},R=new WeakMap,o=new WeakMap,z=new WeakMap,m=new WeakMap,N=new WeakMap,L=new WeakMap,C=new WeakMap,V=new WeakMap,$=new WeakMap,A=new WeakMap,U=new WeakMap,D=new WeakMap,M=new WeakMap,_=new WeakMap,c=new WeakSet,q=function(e){f(this,c,ut).call(this);let s=r(this,o).fetch(this.options,e);return e!=null&&e.throwOnError||(s=s.catch(_t)),s},rt=function(){f(this,c,ot).call(this);const e=W(this.options.staleTime,r(this,o));if(yt||r(this,m).isStale||!vt(e))return;const i=kt(r(this,m).dataUpdatedAt,e)+1;l(this,U,setTimeout(()=>{r(this,m).isStale||this.updateResult()},i))},it=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(r(this,o)):this.options.refetchInterval)??!1},nt=function(e){f(this,c,ht).call(this),l(this,M,e),!(yt||w(this.options.enabled,r(this,o))===!1||!vt(r(this,M))||r(this,M)===0)&&l(this,D,setInterval(()=>{(this.options.refetchIntervalInBackground||Kt.isFocused())&&f(this,c,q).call(this)},r(this,M)))},at=function(){f(this,c,rt).call(this),f(this,c,nt).call(this,f(this,c,it).call(this))},ot=function(){r(this,U)&&(clearTimeout(r(this,U)),l(this,U,void 0))},ht=function(){r(this,D)&&(clearInterval(r(this,D)),l(this,D,void 0))},ut=function(){const e=r(this,R).getQueryCache().build(r(this,R),this.options);if(e===r(this,o))return;const s=r(this,o);l(this,o,e),l(this,z,e.state),this.hasListeners()&&(s==null||s.removeObserver(this),e.addObserver(this))},Qt=function(e){Y.batch(()=>{e.listeners&&this.listeners.forEach(s=>{s(r(this,m))}),r(this,R).getQueryCache().notify({query:r(this,o),type:"observerResultsUpdated"})})},xt);function Gt(t,e){return w(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function St(t,e){return Gt(t,e)||t.state.data!==void 0&&ct(t,e,e.refetchOnMount)}function ct(t,e,s){if(w(e.enabled,t)!==!1){const i=typeof s=="function"?s(t):s;return i==="always"||i!==!1&&dt(t,e)}return!1}function Pt(t,e,s,i){return(t!==e||w(i.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&dt(t,s)}function dt(t,e){return w(e.enabled,t)!==!1&&t.isStaleByTime(W(e.staleTime,t))}function Ht(t,e){return!H(t.getCurrentResult(),e)}var Yt=class extends Ft{constructor(t,e){super(t,e)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(t,e){super.setOptions({...t,behavior:Ot()},e)}getOptimisticResult(t){return t.behavior=Ot(),super.getOptimisticResult(t)}fetchNextPage(t){return this.fetch({...t,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(t){return this.fetch({...t,meta:{fetchMore:{direction:"backward"}}})}createResult(t,e){var Q,K;const{state:s}=t,i=super.createResult(t,e),{isFetching:n,isRefetching:u,isError:a,isRefetchError:d}=i,g=(K=(Q=s.fetchMeta)==null?void 0:Q.fetchMore)==null?void 0:K.direction,v=a&&g==="forward",p=n&&g==="forward",h=a&&g==="backward",T=n&&g==="backward";return{...i,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:qt(e,s.data),hasPreviousPage:zt(e,s.data),isFetchNextPageError:v,isFetchingNextPage:p,isFetchPreviousPageError:h,isFetchingPreviousPage:T,isRefetchError:d&&!v&&!h,isRefetching:u&&!p&&!T}}},j,F,S,E,x,G,lt,Tt,Jt=(Tt=class extends Mt{constructor(e,s){super();b(this,x);b(this,j);b(this,F);b(this,S);b(this,E);l(this,j,e),this.setOptions(s),this.bindMethods(),f(this,x,G).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var i;const s=this.options;this.options=r(this,j).defaultMutationOptions(e),H(this.options,s)||r(this,j).getMutationCache().notify({type:"observerOptionsUpdated",mutation:r(this,S),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&Rt(s.mutationKey)!==Rt(this.options.mutationKey)?this.reset():((i=r(this,S))==null?void 0:i.state.status)==="pending"&&r(this,S).setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||(e=r(this,S))==null||e.removeObserver(this)}onMutationUpdate(e){f(this,x,G).call(this),f(this,x,lt).call(this,e)}getCurrentResult(){return r(this,F)}reset(){var e;(e=r(this,S))==null||e.removeObserver(this),l(this,S,void 0),f(this,x,G).call(this),f(this,x,lt).call(this)}mutate(e,s){var i;return l(this,E,s),(i=r(this,S))==null||i.removeObserver(this),l(this,S,r(this,j).getMutationCache().build(r(this,j),this.options)),r(this,S).addObserver(this),r(this,S).execute(e)}},j=new WeakMap,F=new WeakMap,S=new WeakMap,E=new WeakMap,x=new WeakSet,G=function(){var s;const e=((s=r(this,S))==null?void 0:s.state)??Vt();l(this,F,{...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset})},lt=function(e){Y.batch(()=>{var s,i,n,u,a,d,g,v;if(r(this,E)&&this.hasListeners()){const p=r(this,F).variables,h=r(this,F).context;(e==null?void 0:e.type)==="success"?((i=(s=r(this,E)).onSuccess)==null||i.call(s,e.data,p,h),(u=(n=r(this,E)).onSettled)==null||u.call(n,e.data,null,p,h)):(e==null?void 0:e.type)==="error"&&((d=(a=r(this,E)).onError)==null||d.call(a,e.error,p,h),(v=(g=r(this,E)).onSettled)==null||v.call(g,void 0,e.error,p,h))}this.listeners.forEach(p=>{p(r(this,F))})})},Tt),It=y.createContext(!1),Xt=()=>y.useContext(It);It.Provider;function Zt(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var te=y.createContext(Zt()),ee=()=>y.useContext(te);function Nt(t,e){return typeof t=="function"?t(...e):!!t}function se(){}var re=(t,e)=>{(t.suspense||t.throwOnError)&&(e.isReset()||(t.retryOnMount=!1))},ie=t=>{y.useEffect(()=>{t.clearReset()},[t])},ne=({result:t,errorResetBoundary:e,throwOnError:s,query:i})=>t.isError&&!e.isReset()&&!t.isFetching&&i&&Nt(s,[t.error,i]),ae=t=>{t.suspense&&(typeof t.staleTime!="number"&&(t.staleTime=1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},oe=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,he=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function Ut(t,e,s){var v,p,h,T;const i=jt(),n=Xt(),u=ee(),a=i.defaultQueryOptions(t);(p=(v=i.getDefaultOptions().queries)==null?void 0:v._experimental_beforeQuery)==null||p.call(v,a),a._optimisticResults=n?"isRestoring":"optimistic",ae(a),re(a,u),ie(u);const[d]=y.useState(()=>new e(i,a)),g=d.getOptimisticResult(a);if(y.useSyncExternalStore(y.useCallback(O=>{const Q=n?()=>{}:d.subscribe(Y.batchCalls(O));return d.updateResult(),Q},[d,n]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),y.useEffect(()=>{d.setOptions(a,{listeners:!1})},[a,d]),oe(a,g))throw he(a,d,u);if(ne({result:g,errorResetBoundary:u,throwOnError:a.throwOnError,query:i.getQueryCache().get(a.queryHash)}))throw g.error;return(T=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_afterQuery)==null||T.call(h,a,g),a.notifyOnChangeProps?g:d.trackResult(g)}function Dt(t,e){return Ut(t,Ft)}function ue(t,e){const s=jt(),[i]=y.useState(()=>new Jt(s,t));y.useEffect(()=>{i.setOptions(t)},[i,t]);const n=y.useSyncExternalStore(y.useCallback(a=>i.subscribe(Y.batchCalls(a)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),u=y.useCallback((a,d)=>{i.mutate(a,d).catch(se)},[i]);if(n.error&&Nt(i.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:u,mutateAsync:n.mutate}}function ce(t,e){return Ut(t,Yt)}var le=typeof global=="object"&&global&&global.Object===Object&&global,de=typeof self=="object"&&self&&self.Object===Object&&self,fe=le||de||Function("return this")(),k=fe.Symbol,Lt=Object.prototype,be=Lt.hasOwnProperty,pe=Lt.toString,B=k?k.toStringTag:void 0;function ge(t){var e=be.call(t,B),s=t[B];try{t[B]=void 0;var i=!0}catch{}var n=pe.call(t);return i&&(e?t[B]=s:delete t[B]),n}var ye=Object.prototype,ve=ye.toString;function me(t){return ve.call(t)}var Oe="[object Null]",Re="[object Undefined]",Ct=k?k.toStringTag:void 0;function Se(t){return t==null?t===void 0?Re:Oe:Ct&&Ct in Object(t)?ge(t):me(t)}function Pe(t){return t!=null&&typeof t=="object"}var Ce="[object Symbol]";function we(t){return typeof t=="symbol"||Pe(t)&&Se(t)==Ce}function Ee(t,e){for(var s=-1,i=t==null?0:t.length,n=Array(i);++s<i;)n[s]=e(t[s],s,t);return n}var xe=Array.isArray,Te=1/0,wt=k?k.prototype:void 0,Et=wt?wt.toString:void 0;function $t(t){if(typeof t=="string")return t;if(xe(t))return Ee(t,$t)+"";if(we(t))return Et?Et.call(t):"";var e=t+"";return e=="0"&&1/t==-Te?"-0":e}function Me(t){return t==null?"":$t(t)}var je=0;function Fe(t){var e=++je;return Me(t)+e}async function Qe(t){const e=Math.ceil(t/10);return await J(1e3*2),(await fetch(`/project-preview/data/order-${e}.json`).then(i=>i.json()))[(t-1)%10]}async function Ie(t){return await J(1e3*2),t<1||t>3?[]:await fetch(`/project-preview/data/order-${t}.json`).then(s=>s.json())}async function Ne(t,e){return await J(100*10),`${Fe("order-")}${t}_${e}`}async function Ue(t){return await J(500*1),console.log(`orderPay ${t}`),Math.random()>.1}function _e(t){const e=y.useMemo(()=>{const s=Number(t);return Number.isNaN(s)?void 0:s},[t]);return Dt({queryKey:["order","detail",e],queryFn:()=>Qe(Number(e)),enabled:!!e})}function ke(){const t=ce({queryKey:["order","list"],initialPageParam:1,queryFn:({pageParam:s=1})=>(console.log(s),Ie(s)),getNextPageParam:(s,i)=>{const n=i.length+1;return n<=3?n:void 0}}),e=y.useMemo(()=>{var i;return((i=t.data)==null?void 0:i.pages.flat())??[]},[t.data]);return{...t,list:e}}function Ke(t,e){return Dt({queryKey:["order","new",t,e],queryFn:()=>Ne(t,e),enabled:!!t&&!!e})}function Be(){const t=Wt();return ue({mutationFn:e=>Ue(`${e}`),onSuccess(){t("/order/result")}})}export{_e as a,Dt as b,Ke as c,Be as d,ke as u};
